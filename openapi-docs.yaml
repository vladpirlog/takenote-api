openapi: 3.0.0
info:
  description: |
    This is the OpenAPI documentation for the TakeNote REST API. You can find
    out more at [https://app.swaggerhub.com/apis/vladpirlog/takenote-api/1.0.0]
    (https://app.swaggerhub.com/apis/vladpirlog/takenote-api/1.0.0).
  version: "1.0.0"
  title: TakeNote REST API
  termsOfService: "http://swagger.io/terms/"
  contact:
    email: avi.pirlog@gmail.com
  license:
    name: MIT License
    url: "https://opensource.org/licenses/MIT"
servers:
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/vladpirlog/takenote-api/1.0.0
tags:
  - name: auth
    description: Everything related to the users and authentication
  - name: notes
    description: Everything related to the users' notes
  - name: collaborators
    description: Other users with the ability to read (and write to) some user's note
  - name: attachments
    description: Images, alongside a title and a description, attached to a note
  - name: tokens
    description: A string id with an expiration time, which grant a user the ability to reset password or confirm the email
paths:
  /status:
    get:
      summary: Get server status
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Server is ok
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  /auth/me:
    get:
      tags:
        - auth
      summary: Get authenticated user
      operationId: getMe
      security:
        - cookieAuth: []
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Authenticated user fetched
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  user:
                    additionalProperties: false
                    type: object
                    properties:
                      userID:
                        type: string
                        pattern: /^u[a-zA-Z0-9_-]{24}$/
                        maxLength: 25
                        minLength: 25
                      username:
                        type: string
                        pattern: /^[a-zA-Z0-9_-]{4,16}$/
                        maxLength: 16
                        minLength: 4
                      email:
                        type: string
                        pattern: /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
                        maxLength: 254
                        minLength: 3
  /auth/login:
    post:
      tags:
        - auth
      summary: Login
      operationId: login
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Authentication successful
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  userID:
                    type: string
                    pattern: /^u[a-zA-Z0-9_-]{24}$/
                    maxLength: 25
                    minLength: 25
      requestBody:
        $ref: "#/components/requestBodies/Login"
  /auth/logout:
    post:
      tags:
        - auth
      summary: Logout
      operationId: logout
      security:
        - cookieAuth: []
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: User logged out
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  /auth/register:
    post:
      tags:
        - auth
      summary: Register
      operationId: register
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "201":
          description: User created successfully
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 201
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  userID:
                    type: string
                    pattern: /^u[a-zA-Z0-9_-]{24}$/
                    maxLength: 25
                    minLength: 25
      requestBody:
        $ref: "#/components/requestBodies/Register"
  /auth/confirm:
    post:
      tags:
        - auth
        - tokens
      summary: Confirm email address
      operationId: confirm
      parameters:
        - name: token
          in: query
          description: The token to be used for confirmation
          required: true
          schema:
            type: string
            pattern: /^cn[a-zA-Z0-9_-]{24}$/
            maxLength: 26
            minLength: 26
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Email address confirmed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
        "202":
          description: A new confirmation token was sent to the user's email address
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  /auth/request_confirmation:
    post:
      tags:
        - auth
        - tokens
      summary: Request a new confirmation token
      operationId: requestConfirmationToken
      security:
        - cookieAuth: []
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Confirmation token sent to the user's email address
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  /auth/reset_password:
    post:
      tags:
        - auth
        - tokens
      summary: Request pw reset token
      operationId: resetPassword
      security:
        - cookieAuth: []
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Reset token sent
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
      requestBody:
        $ref: "#/components/requestBodies/OldPassword"
  /auth/rpassword:
    post:
      tags:
        - auth
        - tokens
      summary: Submit reset token
      operationId: submitResetToken
      security:
        - cookieAuth: []
      parameters:
        - name: token
          in: query
          description: The token to be checked against the user's ResetToken
          required: true
          schema:
            type: string
            pattern: /^rs[a-zA-Z0-9_-]{24}$/
            maxLength: 26
            minLength: 26
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Password changed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
      requestBody:
        $ref: "#/components/requestBodies/NewPassword"
  /auth/forgot_password:
    post:
      tags:
        - auth
        - tokens
      summary: Request pw forgot token
      operationId: requestForgotToken
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Forgot token sent
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
      requestBody:
        $ref: "#/components/requestBodies/ForgotPassword"
  /auth/fpassword:
    post:
      tags:
        - auth
        - tokens
      summary: Submit forgot token
      operationId: submitForgotToken
      parameters:
        - name: token
          in: query
          description: The token to be checked against the user's ForgotToken
          required: true
          schema:
            type: string
            pattern: /^fr[a-zA-Z0-9_-]{24}$/
            maxLength: 26
            minLength: 26
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Password changed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
      requestBody:
        $ref: "#/components/requestBodies/NewPassword"
  /auth/check_token:
    get:
      tags:
        - auth
        - tokens
      summary: Check token
      operationId: checkToken
      parameters:
        - name: token
          in: query
          description: The token to be checked
          required: true
          schema:
            type: string
            pattern: /^(rs|fr|cn)[a-zA-Z0-9_-]{24}$/
            maxLength: 26
            minLength: 26
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Reset token valid (not expired)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  /auth/delete:
    post:
      tags:
        - auth
      summary: Delete account
      operationId: deleteMe
      security:
        - cookieAuth: []
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Account is being deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
      requestBody:
        $ref: "#/components/requestBodies/OldPassword"
  /auth/recover:
    post:
      tags:
        - auth
      summary: Recover account
      operationId: recoverMe
      security:
        - cookieAuth: []
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Account is now active
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  /notes:
    get:
      tags:
        - notes
      summary: Get all the user's notes
      operationId: allNotes
      security:
        - cookieAuth: []
      parameters:
        - name: collaborations
          in: query
          required: false
          schema:
            type: boolean
            description: Specifies whether the notes where the user is collaborating should be included
        - name: skip
          in: query
          required: false
          schema:
            type: integer
            format: int32
            description: The number of notes to skip from the result
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            format: int32
            description: The maximum number of notes to return
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Notes fetched
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                required:
                  - status
                  - message
                  - notes
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  notes:
                    type: array
                    items:
                      $ref: "#/components/schemas/Note"
                  collaboratingNotes:
                    type: array
                    items:
                      $ref: "#/components/schemas/Note"
    post:
      tags:
        - notes
      summary: Add note
      operationId: addNote
      security:
        - cookieAuth: []
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "201":
          description: Note created
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 201
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  note:
                    $ref: "#/components/schemas/Note"
      requestBody:
        $ref: "#/components/requestBodies/AddOrUpdateNote"
  /notes/tags:
    get:
      tags:
        - notes
      summary: Get the user's notes by a tag
      operationId: allNotesByTag
      security:
        - cookieAuth: []
      parameters:
        - name: tag
          in: query
          required: true
          schema:
            type: string
            description: The tag to search by
        - name: match
          in: query
          required: false
          schema:
            type: boolean
            description: If true, return the notes that contain that exact tag, else do a regexp match
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Notes fetched
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                required:
                  - status
                  - message
                  - notes
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  notes:
                    type: array
                    items:
                      $ref: "#/components/schemas/Note"
  "/notes/{noteID}":
    get:
      tags:
        - notes
      summary: One user's note
      operationId: oneNote
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to return
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Note fetched
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  note:
                    $ref: "#/components/schemas/Note"
    put:
      tags:
        - notes
      summary: Update note
      operationId: updateNote
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to update
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Note updated
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  note:
                    $ref: "#/components/schemas/Note"
      requestBody:
        $ref: "#/components/requestBodies/AddOrUpdateNote"
    delete:
      tags:
        - notes
      summary: Delete note
      operationId: deleteNote
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to delete
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Note deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  "/notes/{noteID}/duplicate":
    post:
      tags:
        - notes
      summary: Duplicate a note
      operationId: duplicate
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to share
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Note duplicated
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  note:
                    $ref: "#/components/schemas/Note"
  "/notes/{noteID}/share":
    post:
      tags:
        - notes
      summary: Get sharing URL for a note
      operationId: shareLink
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to share
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
        - name: active
          in: query
          description: Set the sharing URL active or not
          required: false
          schema:
            type: boolean
        - name: get_new
          in: query
          description: Create a new URL instead of retrieving the old one
          required: false
          schema:
            type: boolean
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Link fetched
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  shareURL:
                    type: string
                    pattern: /^\/shared\/s[a-zA-Z0-9_-]{24}$/
                    maxLength: 33
                    minLength: 33
                    description: URL path to the shared note
  "/notes/{noteID}/share/collaborators":
    post:
      tags:
        - notes
        - collaborators
      summary: Add note collaborator
      operationId: addCollaborator
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to add collab to
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Collaborator added
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  permission:
                    $ref: "#/components/schemas/Permission"
      requestBody:
        $ref: "#/components/requestBodies/AddCollaborator"
  "/notes/{noteID}/share/collaborators/{permissionID}":
    delete:
      tags:
        - notes
        - collaborators
      summary: Delete note collaborator
      operationId: deleteCollaborator
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to delete collab from
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
        - name: permissionID
          in: path
          description: ID of the permission to delete
          required: true
          schema:
            type: string
            pattern: /^p[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Collaborator deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  "/notes/{noteID}/tags":
    post:
      tags:
        - notes
      summary: Add tags
      operationId: addTags
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of a note to add tags to
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
        - name: tags
          in: query
          description: Tags to add to the note, separated with commas
          schema:
            type: string
            pattern: /^.*$/
            maxLength: 1000
            minLength: 0
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Tags added
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  tags:
                    type: array
                    items:
                      $ref: "#/components/schemas/Tag"
    delete:
      tags:
        - notes
      summary: Delete tags
      operationId: deleteTags
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of a note to delete tags from
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
        - name: tags
          in: query
          description: Tags to delete from the note, separated with commas
          schema:
            type: string
            pattern: /^.*$/
            maxLength: 1000
            minLength: 0
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Tags deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
  "/notes/{noteID}/attachments":
    post:
      tags:
        - notes
        - attachments
      summary: Add attachment
      operationId: addAttachment
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to add attachment to
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Attachment added
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  attachment:
                    $ref: "#/components/schemas/Attachment"
      requestBody:
        $ref: "#/components/requestBodies/AddAttachment"
  "/notes/{noteID}/attachments/{attachmentID}":
    put:
      tags:
        - notes
        - attachments
      summary: Update attachment
      operationId: updateAttachment
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to update attachment from
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
        - name: attachmentID
          in: path
          description: ID of attachment to update
          required: true
          schema:
            type: string
            pattern: /^a[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Attachment edited
          content:
            application/json:
              schema:
                additionalProperties: false
                type: object
                properties:
                  status:
                    type: integer
                    format: int32
                    enum:
                      - 200
                    description: HTTP success status code
                  message:
                    type: string
                    pattern: /^[a-zA-Z0-9_\-.,]*$/
                    maxLength: 1000
                  attachment:
                    $ref: "#/components/schemas/Attachment"
      requestBody:
        $ref: "#/components/requestBodies/UpdateAttachment"
    delete:
      tags:
        - notes
        - attachments
      summary: Delete attachment
      operationId: deleteAttachment
      security:
        - cookieAuth: []
      parameters:
        - name: noteID
          in: path
          description: ID of note to delete attachment from
          required: true
          schema:
            type: string
            pattern: /^n[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
        - name: attachmentID
          in: path
          description: ID of attachment to delete
          required: true
          schema:
            type: string
            pattern: /^a[a-zA-Z0-9_-]{24}$/
            maxLength: 25
            minLength: 25
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "200":
          description: Attachment deleted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResponseBody"
externalDocs:
  description: Find out more about Swagger
  url: "http://swagger.io"
components:
  schemas:
    Permission:
      additionalProperties: false
      type: object
      properties:
        _id:
          type: string
          pattern: /^p[a-zA-Z0-9_-]{24}$/
          maxLength: 25
          minLength: 25
        subject:
          type: string
          pattern: /^u[a-zA-Z0-9_-]{24}$/
          maxLength: 25
          minLength: 25
        level:
          type: integer
          format: int32
          enum:
            - 0
            - 1
    Attachment:
      additionalProperties: false
      type: object
      properties:
        _id:
          type: string
          pattern: /^a[a-zA-Z0-9_-]{24}$/
          maxLength: 25
          minLength: 25
        url:
          type: string
          description: A valid URL of a photo
          pattern: /^[a-zA-Z0-9_\-.:\/\\?!=+\|]$/
          maxLength: 300
          minLength: 5
        title:
          type: string
          pattern: /^[a-zA-Z0-9_\-.,]{0,32}$/
          maxLength: 32
          minLength: 0
        description:
          type: string
          pattern: /^[a-zA-Z0-9_\-.,]{0,256}$/
          maxLength: 256
          minLength: 0
    Tag:
      type: string
      pattern: /^.*$/
      maxLength: 100
    Token:
      additionalProperties: false
      type: object
      properties:
        _id:
          type: string
          pattern: /^(rs|fr|cn)[a-zA-Z0-9_-]{24}$/
          maxLength: 26
          minLength: 26
        exp:
          type: integer
          format: int32
          minimum: 1000000000
          maximum: 2147483647
    User:
      additionalProperties: false
      type: object
      required:
        - _id
        - username
        - password
        - email
        - salt
        - state
        - role
        - createdAt
        - updatedAt
      properties:
        _id:
          type: string
          pattern: /^u[a-zA-Z0-9_-]{24}$/
          maxLength: 25
          minLength: 25
        username:
          type: string
          pattern: /^[a-zA-Z0-9_-]{4,16}$/
          maxLength: 16
          minLength: 4
        email:
          type: string
          pattern: /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
          maxLength: 254
          minLength: 3
        password:
          type: string
          pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24}$/
          maxLength: 24
          minLength: 8
        salt:
          type: string
          pattern: /^.*$/
          maxLength: 32
        state:
          type: string
          enum:
            - unconfirmed
            - active
            - deleting
            - deleted
        confirmationToken:
          $ref: "#/components/schemas/Token"
        role:
          type: integer
          format: int32
          enum:
            - -1
            - 0
            - 1
            - 2
        resetToken:
          $ref: "#/components/schemas/Token"
        forgotToken:
          $ref: "#/components/schemas/Token"
        createdAt:
          type: string
          format: date-time
          maxLength: 100
        updatedAt:
          type: string
          format: date-time
          maxLength: 100
    Note:
      additionalProperties: false
      type: object
      required:
        - _id
        - owner
        - archived
        - share
        - color
        - createdAt
        - updatedAt
      properties:
        _id:
          type: string
          pattern: /^n[a-zA-Z0-9_-]{24}$/
          maxLength: 25
          minLength: 25
        title:
          type: string
          pattern: /^[a-zA-Z0-9_\-.,]{0,100}$/
          maxLength: 100
          minLength: 0
        content:
          type: string
          pattern: /^[a-zA-Z0-9_\-.,]{0,10000}$/
          maxLength: 10000
          minLength: 0
        owner:
          type: string
          pattern: /^u[a-zA-Z0-9_-]{24}$/
          maxLength: 25
          minLength: 25
        permissions:
          type: array
          maxItems: 10
          items:
            $ref: "#/components/schemas/Permission"
        attachments:
          type: array
          maxItems: 10
          items:
            $ref: "#/components/schemas/Attachment"
        tags:
          type: array
          maxItems: 20
          items:
            $ref: "#/components/schemas/Tag"
        share:
          additionalProperties: false
          type: object
          required:
            - active
          properties:
            active:
              type: boolean
            code:
              type: string
              pattern: /^s[a-zA-Z0-9_-]{24}$/
              maxLength: 25
              minLength: 25
        archived:
          type: boolean
        color:
          type: string
          pattern: /^#[0-9abcdef]{6}$/
          maxLength: 7
          minLength: 7
        createdAt:
          type: string
          format: date-time
          maxLength: 100
        updatedAt:
          type: string
          format: date-time
          maxLength: 100
    ResponseBody:
      additionalProperties: false
      type: object
      required:
        - status
        - message
      properties:
        status:
          type: integer
          format: int32
          minimum: 200
          maximum: 299
          description: HTTP success status code
        message:
          type: string
          pattern: /^[a-zA-Z0-9_\-.,]*$/
          maxLength: 1000
    Error:
      additionalProperties: false
      type: object
      required:
        - status
        - message
      properties:
        status:
          type: integer
          format: int32
          minimum: 400
          maximum: 599
          description: HTTP error status code
        message:
          type: string
          pattern: /^[a-zA-Z0-9_\-.,]*$/
          maxLength: 200
          description: A brief summary of the error
  requestBodies:
    Login:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            required:
              - email
              - password
            properties:
              email:
                type: string
                pattern: /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
                maxLength: 254
                description: The user's email or username
              password:
                type: string
                format: password
                pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24}$/
                maxLength: 24
                minLength: 8
                description: The user's password
      description: The user's credentials required for authentication
      required: true
    Register:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            required:
              - username
              - email
              - password
              - confirm_password
            properties:
              username:
                type: string
                pattern: /^[a-zA-Z0-9_-]{4,16}$/
                maxLength: 16
                minLength: 4
                description: The chosen username
              email:
                type: string
                pattern: /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
                maxLength: 254
                minLength: 3
                description: The user's email
              password:
                type: string
                format: password
                pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24}$/
                maxLength: 24
                minLength: 8
                description: The user's password
              confirm_password:
                type: string
                format: password
                pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24}$/
                maxLength: 24
                minLength: 8
                description: The user's password entered again
      description: The user's info required for registration
    OldPassword:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            required:
              - old_password
            properties:
              old_password:
                type: string
                format: password
                pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24}$/
                maxLength: 24
                minLength: 8
                description: The user's password
      description: The user's old password required for changing it to a new one
    ForgotPassword:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            required:
              - email
            properties:
              email:
                type: string
                pattern: /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
                maxLength: 254
                description: The user's email or username
      description: The user's current username or email address required for resetting the password when forgotten
      required: true
    NewPassword:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            required:
              - new_password
              - confirm_new_password
            properties:
              new_password:
                type: string
                format: password
                pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24}$/
                maxLength: 24
                minLength: 8
                description: The user's password
              confirm_new_password:
                type: string
                format: password
                pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24}$/
                maxLength: 24
                minLength: 8
                description: The user's password again
      description: The user's old password required for changing it to a new one
    AddOrUpdateNote:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            properties:
              title:
                type: string
                pattern: /^[a-zA-Z0-9_\-.,]{0,100}$/
                maxLength: 100
                minLength: 0
              content:
                type: string
                pattern: /^[a-zA-Z0-9_\-.,]{0,10000}$/
                maxLength: 10000
                minLength: 0
              archived:
                type: string
                enum:
                  - "true"
                  - "false"
              color:
                type: string
                pattern: /^#[0-9abcdef]{6}$/
                maxLength: 7
                minLength: 7
    AddCollaborator:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            required:
              - user
              - type
            properties:
              user:
                type: string
                pattern: /^([a-zA-Z0-9_-]{4,16})|((([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,})))|((?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&-_.,/\\])[A-Za-z\d@$!%*?&-_.,/\\]{8,24})$/
                maxLength: 254
                minLength: 3
                description: Username, email or id of the user to make collab
              type:
                type: string
                enum:
                  - r
                  - rw
    AddAttachment:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            required:
              - photo
            properties:
              photo:
                type: string
                format: binary
                description: Image to be added as attachment
              title:
                type: string
                pattern: /^[a-zA-Z0-9_\-.,]{0,32}$/
                maxLength: 32
                minLength: 0
              description:
                type: string
                pattern: /^[a-zA-Z0-9_\-.,]{0,256}$/
                maxLength: 256
                minLength: 0
    UpdateAttachment:
      content:
        multipart/formdata:
          schema:
            additionalProperties: false
            type: object
            properties:
              title:
                type: string
                pattern: /^[ -~]{0,32}$/
                maxLength: 32
                minLength: 0
              description:
                type: string
                pattern: /^[ -~]{0,256}$/
                maxLength: 256
                minLength: 0
  securitySchemes:
    cookieAuth:
      type: apiKey
      description: JWT signed token used for authentication
      name: access_token
      in: cookie
